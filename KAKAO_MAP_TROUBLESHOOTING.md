# 카카오맵 API 문제 해결 가이드

## 🔍 지도가 안 나올 때 확인 사항

### 1️⃣ 브라우저 콘솔 확인
1. 브라우저에서 `F12` 키를 누르세요
2. **Console** 탭을 확인하세요
3. 다음과 같은 로그들을 찾으세요:

#### 정상 작동 시:
```
✅ 카카오맵 API 로드 성공
✅ 지도 컨테이너 발견
📍 시장 주소: 서울특별시 중구 남대문로 21
🏪 시장 이름: 남대문시장
✅ 카카오맵 API 사용 가능
🗺️ 지도 생성 시작...
✅ 지도 생성 완료
🔍 주소 검색 시작
✅ 주소 검색 성공
✅ 마커 및 정보창 표시 완료
✅ 지도 로드 완료
```

#### 오류 발생 시 확인할 메시지:
```
❌ 카카오맵 API가 로드되지 않았습니다
❌ 주소 정보가 없습니다
❌ 주소 검색 실패
```

### 2️⃣ 카카오 개발자 센터 플랫폼 설정 확인

가장 흔한 오류 원인! **도메인이 등록되지 않은 경우**

1. [카카오 개발자 센터](https://developers.kakao.com/) 로그인
2. 내 애플리케이션 선택
3. **플랫폼** 메뉴 클릭
4. **Web 플랫폼 등록** 확인

#### 반드시 등록해야 할 도메인:
```
http://localhost:8080
```

만약 다른 포트를 사용한다면:
```
http://localhost:포트번호
```

배포 시:
```
https://yourdomain.com
```

### 3️⃣ API 키 확인

`application.properties` 파일 확인:
```properties
kakao.map.api.key=be570b3ab5e159c8e0afc5d9e818fe85
```

- API 키가 정확한지 확인
- JavaScript 키인지 확인 (REST API 키 아님!)
- 32자리 문자열인지 확인

### 4️⃣ 애플리케이션 재시작

API 키를 변경한 후에는 **반드시 애플리케이션을 재시작**해야 합니다!

```bash
# 애플리케이션 중지 후 다시 실행
.\gradlew.bat bootRun
```

또는 IntelliJ/VS Code에서 실행 중인 애플리케이션을 중지하고 다시 시작하세요.

### 5️⃣ 시장 데이터 확인

데이터베이스에 주소가 제대로 입력되어 있는지 확인:
```sql
SELECT market_id, market_name, market_address 
FROM market 
LIMIT 5;
```

주소가 없거나 잘못된 형식이면 지도가 표시되지 않습니다.

### 6️⃣ 네트워크 확인

브라우저 개발자 도구 > Network 탭에서:
- `dapi.kakao.com` 요청이 있는지 확인
- 상태 코드가 200 OK인지 확인
- 401 Unauthorized 또는 403 Forbidden이면 API 키 또는 도메인 설정 오류

## 🆘 자주 발생하는 오류와 해결법

### 오류 1: "카카오맵 API가 로드되지 않았습니다"
**원인:**
- API 키가 잘못됨
- 플랫폼(도메인)이 등록되지 않음
- 네트워크 오류

**해결:**
1. 카카오 개발자 센터에서 `http://localhost:8080` 등록
2. API 키 재확인
3. 애플리케이션 재시작

### 오류 2: "주소를 찾을 수 없습니다"
**원인:**
- 데이터베이스에 주소가 없음
- 주소 형식이 잘못됨

**해결:**
1. DB에서 market_address 확인
2. 정확한 도로명 주소 또는 지번 주소 입력
3. 예: "서울특별시 중구 남대문로 21"

### 오류 3: 지도는 나오는데 마커가 없음
**원인:**
- 주소 검색은 실패했지만 기본 지도는 표시됨

**해결:**
- 콘솔에서 "주소 검색 실패" 메시지 확인
- 주소를 더 정확하게 입력

## 📝 테스트 체크리스트

- [ ] 카카오 개발자 센터에서 JavaScript 키 발급 완료
- [ ] `http://localhost:8080` 도메인 등록 완료
- [ ] `application.properties`에 API 키 입력 완료
- [ ] 애플리케이션 재시작 완료
- [ ] 브라우저에서 `/markets/1` 페이지 접속
- [ ] F12 콘솔에서 오류 메시지 확인
- [ ] 지도가 정상적으로 표시되는지 확인

## 🔧 빠른 테스트 방법

브라우저 콘솔에 직접 입력해서 테스트:
```javascript
// 카카오맵 API 로드 확인
console.log(typeof kakao); // "object"가 나와야 정상

// 지도 컨테이너 확인
console.log(document.getElementById('map')); // 요소가 나와야 정상

// 주소 데이터 확인
var map = document.getElementById('map');
console.log(map.getAttribute('data-address')); // 주소가 나와야 정상
console.log(map.getAttribute('data-name')); // 시장 이름이 나와야 정상
```

## 💡 도움이 필요하면

콘솔의 전체 로그를 복사해서 공유하면 문제를 정확히 파악할 수 있습니다!
